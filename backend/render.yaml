# Render configuration for backend (stream-schedule-api)
# Root Directory en Render debe ser: backend
#
# NOTA: En el entorno de build "Node" de Render puede que apt-get no esté disponible.
# Si el build falla con "apt-get: not found", configura el servicio con Docker y un
# Dockerfile que haga RUN apt-get update && apt-get install -y ffmpeg.

# Build: instalar FFmpeg nativo (si el entorno lo permite) y dependencias
buildCommand: |
  apt-get update && apt-get install -y ffmpeg || true
  npm install

# Arranque del API (entrypoint real del proyecto)
startCommand: node src/app.js

# Variables de entorno obligatorias para que el pre-deploy (migrate) y el API funcionen:
# - DATABASE_URL: URL de PostgreSQL (Supabase o Render Postgres). En Render Dashboard > Service > Environment.
# - DATABASE_SSL=true: requerido en producción (Supabase/Render exigen SSL).
# Si usas Render PostgreSQL y la migración falla por conexión, asegúrate de que DATABASE_URL
# esté definida en el servicio API (no solo en el servicio DB). El script de migración añade
# sslmode=require automáticamente si no está en la URL.
envVars:
  - NODE_ENV=production
